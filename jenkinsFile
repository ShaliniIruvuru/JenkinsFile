pipeline {
    agent any
   tools {
    maven 'Maven 3.8.7'
    }
    stages {
    stage('Build Maven'){
      steps{
        checkout scmGit(branches: [[name: '*/jenkins']], extensions: [], userRemoteConfigs: [[credentialsId: '0d42cebb-fada-4a71-be79-c77a3bb0ec58', url: 'https://github.com/ShaliniIruvuru/JenkinsFile.git']])
        sh "mvn -Dmaven.test.failure.ignore=true clean package"
           }
      }
     stage('Build docker image'){
        steps{
           script{
               sh 'sudo groupadd docker'
               sh 'sudo usermod -aG docker ${USER}'
               sh 'su -s ${USER}'
              sh 'docker build -t shaliniiruvuru/jenkins_selenium .'  
                 }
              }
          }
          stage('push the image to dockerhub'){
            steps{
             script{
             withCredentials([string(credentialsId: 'dockerhub_pwd', variable: 'dockerhubpwd')]) {
               sh 'docker login -u devopshint -p ${dockerhubpwd}'
                }
                 sh 'docker push shaliniiruvuru/jenkins_selenium'
             
                   }
              }
            } 
          
  
        }
}
